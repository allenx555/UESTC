# 网络安全技术

## 网络安全技术概述

信息安全：在技术上和管理上为数据处理系统建立的安全保护，保护信息系统的硬件、软件及相关数据不因偶然或者恶意的原因遭到破坏、更改及泄露

CIA三要素：保密性、完整性、可用性

网络安全：网络上的信息安全/网络系统的硬件、软件及其系统中的数据受到保护，不会因偶然或者恶意的因素的影响而遭到破坏、更改或泄露，系统能够连续、可靠地正常运行，网络服务不被中断

脆弱性：指系统的硬件资源、通信资源、软件及信息资源等存在的弱点和缺陷。分为以下几类：硬件系统的脆弱性、软件系统的脆弱性、网络和通信协议的脆弱性、管理的脆弱性、用户的脆弱性

安全威胁：可能对系统或组织造成危害的不期望事件的潜在原因。脆弱性的普遍存在是安全威胁产生的根本原因。分为：信息泄露、完整性破坏、服务拒绝、未授权访问

安全攻击：任何危及到信息安全的行为，安全攻击要利用一个或多个系统的脆弱性。分为：被动攻击、主动攻击、物理临近攻击、内部人员攻击、配装分发攻击

被动攻击：被动监视网络上的信息传递过程或内容，如网络监听、流量分析

主动攻击：避开或破坏安全部件， 引入恶意代码，破坏数据或系统完整性

安全服务：提供数据处理和数据传输安全性保护的方法。常见的安全服务有认证服务、访问控制服务、数据保密性服务、数据完整性服务、不可否认服务

安全机制：保护信息与信息系统安全技术措施的总称，分为：加密、数字签名、访问控制、数据完整性、鉴别交换、业务流填充、路由控制、公证

安全服务和安全机制的关系：安全服务体现网络信息系统的安全需求、安全机制是实现安全服务采取的具体技术措施、安全服务与安全机制是多对多的关系、安全服务可以用不同的安全机制来实现、安全机制可以用来实现不同的安全服务



## 网络协议的安全性分析

### TCP/IP网络模型 OSI参考模型

![img](https://images2015.cnblogs.com/blog/784487/201701/784487-20170118164512515-2009100776.png)

安全性问题分类：设计缺陷导致的安全性问题、实现缺陷导致的安全性问题

安全威胁：信息泄露、消息伪造、拒绝服务

消息伪造：TCP/IP协议在设计时没有考虑身份鉴别和完整性服务，导致消息容易被伪造。

拒绝服务：TCP/IP协议在设计时没有考虑可用性服务，导致拒绝服务攻击。

### ARP

ARP协议位于网络层与数据链路层之间

工作特点：ARP是即插即用的，无需网络管理员干预，节点就能创建ARP表；响应ARP请求的主机将请求者的IP－MAC映射缓存、主动的ARP应答会被视为有效信息接受

安全威胁：认证问题、无状态性、缓存需要定时更新

ARP欺骗：攻击者在局域网段发送虚假的IP/MAC对应信息，篡改网关MAC地址

### IP

IP假冒攻击：IP协议本身没有验证源IP地址真实性的机制；拒绝服务、基于 IP 地址认证的网络服务欺骗

IP碎片攻击：IP数据包最长只能为0xFFFF/65535字节

### TCP

TCP协议的特点：

- 全双工连接

- 面向连接：三次握手

- 可靠性：自动分片；保证传送给应用层的数据顺序是正确的 ；自动过滤重复的封包 ；确认-重传确保数据包可靠到达 

- 面向字节流：应用程序和网络传输相分割，提供了一致的接口

安全威胁：

-  拒绝服务：利用网络协议漏洞或其他系统以及应用软件的漏洞耗尽被攻击目标资源，使得被攻击的计算机或网络无法正常提供服务，直至系统停止响应甚至崩溃；利用TCP面向连接的特点 
- SYN Flooding：很少的数据流量；攻击来源无法定位；服务端无法区分TCP连接请求是否合法

- ACK Flooding：主机接收到带有ACK状态的数据包，需要检测数据包所包含的连接四元组是否存在，如存在需要检查数据包状态数据是否合法
- 序列号猜测攻击（会话劫持）：通过猜测序列号，在TCP会话中插入自己构造的数据包
- Land攻击：构造SYN包，其源地址和目标地址都被设置成某一个服务器地址

### UDP

UDP假冒

UDP劫持

### DNS

DNS查询和应答是基于UDP的应用，验证不同的查询/应答是依靠报文中的标识段（ID）

DNS欺骗：获得标识号ID——结合ARP欺骗或ICMP重定向等手段，采用嗅探的方法得到

DNS猜测（生日）攻击：大量查询——大量猜测ID伪造应答数据表

DNS缓存毒化

基于DNS的DDoS

### HTTP

钓鱼攻击

跨站攻击：XSS

## 身份认证技术

身份认证：身份认证是证实主体的真实身份与其所声称的身份是否相符的过程，身份认证可分为用户（代表用户的进程）与主机间的认证和主机与主机之间的认证

目的：验证用户，对抗假冒、依据身份，实施控制、明确责任，便于审计

作用：为了保护网络资源及落实安全策略。需要提供可追究责任的机制，这里涉及到三个概念。身份认证是第一道防线

技术分类：

- 按认证因子数量分类：单因子认证、双因子认证、多因子认证

- 按认证因子状态分类：静态认证、动态认证

### 基于口令的身份认证

口令猜测与穷举（暴力、字典）攻击：利用用户信息安全意识不高，口令质量不高，实施的口令猜测或穷举攻击

防范方法：设置安全口令、强化口令安全策略、增加认证信息量

口令嗅探攻击：利用网络协议采用明文或简单编码方式传输口令，通过网络嗅探方式获取用户口令

防范方法：采用加密方式进行口令传输。 

口令窃取攻击（服务器端）：如果口令以明文方式存储，攻击者可以通过攻击存储口令的服务器获取用户口令

防范方法：基于单向函数的口令认证、加盐（salt）的单向函数口令认证

口令窃取攻击（用户端）：攻击者通过木马程序监听键盘输入，从而获取用户口令

防范方法：使用安全控件，通过对关键数据进行加密

口令重放攻击：通过网络嗅探获取包含口令等认证信息的数据包，在随后的验证过程中使用该数据包发起身份认证请求，欺骗认证服务器

防范方法：采用动态口令（SKEY序列密码）

### 基于对称密码的身份认证

ISO/IEC9798-2协议——时间戳

ISO/IEC9798-2协议 —— 基于一次性随机数

### 基于对称密码的身份认证

使用第三方的认证协议—— Needham-Schroeder 协议

![image-20191228233901787](C:\Users\allen\AppData\Roaming\Typora\typora-user-images\image-20191228233901787.png)

使用第三方的认证协议——Denning-Sacco协议

### 基于公钥密码的身份认证

工作原理：私钥只有指定用户持有

ISO/IEC9798-3协议——单向认证

ISO/IEC9798-3协议——双向认证

X.509认证协议——基于数字证书

## 访问控制技术

概念：访问控制是通过某种途径显式地准许或限制访问能力及范围的一种方法。通过限制对关键资源的访问，防止非法用户的侵入或因为合法用户的不慎操作而造成的破坏，从而保证网络资源受控地、合法地使用，它是针对越权使用资源的防御措施

工作原理：确权，系统资源的访问权限存放在访问控制策略数据库中；审核，通过一个参考监视器（ Reference Monitor）监视用户对系统资源访问的行为；决策，依据访问控制策略数据库的规则 ，确定是否允许访问操作

### 访问控制应用模型

访问控制的核心是建立描述主体对客体访问能力的访问策略，而具体访问控制策略的确定是由采用何种访问控制应用模型决定的。所谓访问控制应用模型就是用来描述主体、客体间授权关系的一种形式化方式

#### 自主访问控制模型

确认主体身份及所属组的基础上，根据访问者的身份和授权来决定访问模式，对访问进行限定的一种控制策略

优点：与业务和应用场景无关，其自主性为用户权限管理提供了最大限度的灵活性，在通用操作系统中普遍使用

缺点：自主访问控制的安全级别较低；用户、权限、客体间的授权管理复杂

局限性：不能实现全局性访问控制、不能区分所有权和访问权、不能体现严格的组织架构

#### 强制访问控制模型

由安全管理员统一对主体和客体的安全标签赋值，普通用户不能改变；

安全标签就是安全级，客体的安全级表现了客体中所含信息的敏感程度，而主体的安全级别则反映了主体对敏感信息的可信程度。

根据访问者的安全等级和被访问客体的安全等级来决定访问模式，可以提供严格的访问控制策略保障。

BLP模型：用λ标志主体或客体的安全标签，主体按照“向下读，向上写”的原则访问客体，使得系统中的信息流程为单向不可逆的，保证了信息流总是低安全级别的实体流向高安全级别的实体，机密性

BiBa模型：用λ标志主体或客体的安全标签，主体按照“向上读，向下写”的原则访问客体，使得系统中的信息流总是高安全级别的实体流向低安全级别的实体，因此，BiBa能有效地保护数据的完整性

优点：通过梯度安全标签实现信息的单向流通，BLP模型可以保证数据的机密性，BiBa模型可以保护数据的完整性，比自主访问控制有更高的安全性。

缺点：强制访问控制由于强调信息流通的单向性，造成实现工作量太大，管理不便，可用性和灵活性差。

#### 基于角色的访问控制模型

管理员创建角色，给角色分配权限，让用户关联角色，角色所属的用户可以执行相应的权限；实现了用户和权限的分离，具有支持权限的继承，与实际应用密切关联等特点

基本安全原则：最小权限、责任分离、数据抽象

模型分类：基本RBAC（Core RBAC）、分级RBAC（Hierarchical RBAC）、静态责任分离（Static Separation of Duty Relations）、动态责任分离（Dynamic Separation of Duty relations）

动态责任分离RBAC工作流程：

①用户登录时向身份认证模块发送用户标识、用户口令，确证用户身份；

②会话管理模块从RBAC数据库检索该用户的授权角色集并送回用户；

③用户从中选择本次会话的活跃角色集，在此过程中会话管理模块维持动态角色互斥；

④会话创建成功，本次会话的授权许可体现在菜单与按钮上，如不可用显示为灰色

⑤在此会话过程中，系统管理员若要更改角色或许可，可在此会话结束后进行或终止此会话立即进行。

优点：便于权限的安全控制、 便于业务的权限分离、便于最小化权限管理、便于权限的分级管理

缺点：功能实现复杂、授权流程复杂

### 访问控制实现机制

访问控制的实现机制是指在具体系统中采用何种方式来记录主体与客体间的授权关系

![image-20191229193605640](C:\Users\allen\AppData\Roaming\Typora\typora-user-images\image-20191229193605640.png)

## 网络扫描技术

网络扫描技术是一种用于发现Internet远程目标网络或本地主机安全性脆弱点的技术。通过网络扫描，可以获取各种TCP/IP端口的分配、开放的服务、Web服务软件版本和这些服务及软件呈现在Internet上的安全漏洞 

分类：

- 主机扫描：确定在目标网络上的主机是否可达，同时尽可能多映射目标网络的拓扑结构，主要利用ICMP数据包；

- 端口扫描：发现远程主机开放的端口以及服务；

- 操作系统扫描：根据扫描获取的特征判别操作系统；

- 漏洞扫描：检测出目标系统存在的安全漏洞。

### 主机扫描

传统主机扫描技术：

ICMP Echo ：通过简单地向目标主机发送ICMP Echo Request 数据包，并等待回复的ICMP Echo Reply 包，如Ping；

ICMP Sweep（Ping Sweep）：使用ICMP Echo Request一次探测多个目标主机。通常这种探测包会并行发送，以提高探测效率，如pingsweep工具；

Broadcast ICMP ：设置ICMP请求包的目标地址为广播地址或网络地址，则可以探测广播域或整个网络范围内的主机，这种情况只适合于UNIX/Linux系统；

Non-Echo ICMP：其它ICMP服务类型（13和14、15和16、17和18）也可以用于对主机或网络设备如路由器等的探测。

高级主机扫描技术：利用被探测主机产生的ICMP错误报文来进行复杂的主机探测——异常的IP包头、在IP头中设置无效的字段值、通过超长包探测内部路由器、反向映射探测

### 端口扫描

一个端口就是一个潜在的通信通道，也就是一个入侵通道。对目标计算机进行端口扫描，能得到许多有用的信息，从而发现系统的安全漏洞。它使扫描者了解系统目前向外界提供了哪些服务，从而为系统的入侵提供了一种手段

端口扫描分类：开放/全连接扫描、半开放/半连接扫描、秘密扫描（半开放和秘密扫描需要系统权限）；开放扫描Connect、半开放扫描SYN、秘密扫描FIN

### 操作系统扫描

通过系统服务获取标识信息

协议栈查询技术

特征值在不同操作系统的表现： “DF”位、TCP初始窗、ACK值

## 网络安全隔离技术

隔离技术是指通过对具有不同安全需求的应用系统进行分类保护，从而有助于将风险较大的应用系统与其他需要更多安全保护的应用系统隔离，达到保护的目的

本质需求：既要信息交换或共享资源，又要通过隔离提高安全性保障

隔离的类型：逻辑隔离、物理隔离

### 交换机与网络隔离

交换机的功能：物理编址、网络拓扑结构、错误校验、帧序列化、流量控制

交换机直接隔离、虚拟子网（Vlan）的隔离

Vlan的划分方式：

![image-20191230145409088](C:\Users\allen\AppData\Roaming\Typora\typora-user-images\image-20191230145409088.png)

### 路由器与网络隔离

路由器功能：网络互连、数据处理、网络管理、数据处理、网络管理

路由器隔离部署方式：

​	路由器作为唯一安全组件：

- 相对交换机，能提供更高层次的安全功能

- 包过滤，NAT等

​	路由器作为安全组件的一部分：

- 在一个全面安全体系结构中，常用作屏蔽设备，执行包过滤功能，而防火墙对能够通过路由器的数据包进行检查

### 防火墙与网络隔离

防火墙是用一个或一组网络设施，在两个或多个网络间加强访问控制，以保护一个网络不受到另一个网络攻击的安全技术；逻辑上防火墙是一个分离器，一个限制器，也是一个分析器

主要技术：分组（包）过滤、应用代理（网关）、状态检测、链路层代理（网关）

分组过滤防火墙：基于源地址和目的地址、应用、协议类型以及每个IP包的端口来作出通过与否的判断（网络层）

分组过滤基本原则：双向性原则、内外性原则、默认拒绝原则

应用代理防护墙：应用代理可以对数据包的数据区进行分析，并以此判断数据是否允许通过（应用层）

状态检测防火墙：状态检测可以结合前后数据包里的数据信息进行综合分析决定是否允许该包通过（传输层）

链路层代理（SOCKS）防火墙：链路层代理可以对客户端连接请求进行分析，依据客户身份和请求此判是否否允许建立连接（传输层）

防火墙的典型体系结构：包过滤路由器模型、单宿主堡垒主机模型、双宿主堡垒主机模型、子网屏蔽防火墙模型

总结：防火墙是网络安全的屏障、可以强化网络安全策略、可以阻止内部信息外泄、可以作为实现某些网络功能的便利平台

局限性：防火墙无法检测不经过防火墙的流量，如通过内部提供拨号服务接入公网的流量、防火墙不能防范来自内部人员恶意的攻击、防火墙不能阻止被病毒感染的和有害的程序或文件的传递、防火墙不能防止数据驱动式攻击，如一些缓冲区溢出攻击

### 物理隔离

内部网在任何情况下不得直接或间接地连接公共网

类型：双网双机、双硬盘物理隔离卡、单硬盘物理隔离、 隔离网关（网闸）

工作模式：单向隔离、协议隔离、网闸隔离

## **入侵检测技术**

入侵：绕过系统安全机制的非授权行为

入侵检测：一种对计算机系统或网络事件进行监测并分析这些入侵事件特征的过程

### 入侵检测分类

按数据检测方法：异常检测模型（Anomaly Detection )、误用检测模型（Misuse Detection)

按系统结构：集中式、分布式

按时效性：离线入侵检测系统、在线入侵检测系统

按数据来源：基于主机的入侵检测系统（HIDS）、基于网络的入侵检测系统（NIDS）、混合型入侵检测系统（Hybrid IDS）、网络节点入侵检测系统（NNIDS）、文件性检测系统

### 入侵检测技术原理

数据采集技术：高速网络线速采集、包俘获、主机信息采集

数据检测技术：基于误用的检测、基于异常的检测

专家系统

模式匹配：根据知识建立攻击脚本库，每一脚本都由一系列攻击行为组成

#### 基于异常的检测技术

统计分析

数据挖掘：聚类分析、连接分析和顺序分析

TCP连接个体的基本特征、基于时间的特征、基于连接的特征

### 入侵检测系统的主要技术指标

性能能指：

- HIDS：漏报率、误报率、资源占用率；

- NIDS：漏报率、误报率、特征库强度；

功能指标：

- 系统结构：集中/分布式结构、本地/远程管理模式、通讯安全

- 探测引擎：检测能力、事件响应、自身安全

- 控制台：策略灵活性、自定义事件、事件库更新、易用性、综合分析、事件数量 

## 网络攻击与防御

缓冲区：从程序的角度，缓冲区就是应用程序用来保存用户输入数据、程序临时数据的内存空间

缓冲区溢出：如果用户输入的数据长度超出了程序为其分配的内存空间，这些数据就会覆盖程序为其它数据分配的内存空间，形成所谓的缓冲区溢出

栈：由编译器自动分配释放；先入后出；增长方向与内存的地址增长方向正好相反, 从高地址向低地址增长

堆：一般由程序员分配释放，若程序员不释放，程序结束时可由OS回收

计算机病毒：一种程序或代码片段，它用修改其它程序的方法将自身的精确拷贝或者可能演化的拷贝插入其它程序，从而感染其它程序；凡是人为编制的、干扰计算机正常运行并造成计算机软硬件故障，甚至破坏计算机数据的可自我复制的计算机程序或指令集合

传统计算机病毒（按传播方式分类）：网络病毒、文件病毒、引导型病毒、混合型病毒

木马系统软件一般由木马配置程序、控制程序和木马程序(服务器程序)三部分组成，攻击者获得远程访问和控制系统的权限

蠕虫是一种通过网络自动传播它自身功能的拷贝或它的某些部分到其他的计算机系统中的恶意代码，可利用系统缺陷进行自动传播，不需要宿主

病毒检测技术分类：病毒预防技术、病毒检测技术、病毒消除技术、病毒免疫技术

病毒检测技术，手工检测最为可靠，自动检测便捷高效

自动检测分类：特征值检测、校验和检测技术、行为监测法检测技术、启发式代码扫描技术（基于给定的判断规则和定义）

常见的病毒行为特性：占用INT 13H，对可执行文件做写入动作，病毒程序与宿主程序的切换，搜索API函数地址
